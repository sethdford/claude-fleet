<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Documentation - Claude Fleet</title>
  <meta name="description" content="Complete API reference for Claude Fleet - REST endpoints, WebSocket events, and MCP tools.">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@600;700;800&display=swap" rel="stylesheet">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="images/logo.svg">

  <!-- Shared Styles -->
  <link rel="stylesheet" href="styles/shared.css">

  <style>
    /* Documentation Layout */
    .doc-layout {
      display: grid;
      grid-template-columns: 240px 1fr;
      gap: var(--space-2xl);
      padding: 100px 0 var(--space-4xl);
    }

    @media (max-width: 900px) {
      .doc-layout { grid-template-columns: 1fr; }
      .doc-sidebar { display: none; }
    }

    .doc-sidebar {
      position: sticky;
      top: 100px;
      height: fit-content;
      max-height: calc(100vh - 120px);
      overflow-y: auto;
      padding-right: var(--space-md);
    }

    .doc-nav-section {
      margin-bottom: var(--space-lg);
    }

    .doc-nav-title {
      font-size: var(--text-xs);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      margin-bottom: var(--space-sm);
    }

    .doc-nav-link {
      display: block;
      padding: var(--space-xs) var(--space-sm);
      color: var(--text-secondary);
      text-decoration: none;
      font-size: var(--text-sm);
      border-radius: var(--radius-sm);
      transition: all var(--transition-fast);
    }

    .doc-nav-link:hover {
      color: var(--text-primary);
      background: var(--bg-secondary);
    }

    .doc-nav-link.active {
      color: var(--accent-cyan);
      background: rgba(0,212,255,0.1);
    }

    /* Content */
    .doc-content {
      max-width: 800px;
    }

    .doc-content h1 {
      font-size: var(--text-3xl);
      margin-bottom: var(--space-lg);
    }

    .doc-content h2 {
      font-size: var(--text-xl);
      margin-top: var(--space-3xl);
      margin-bottom: var(--space-lg);
      padding-top: var(--space-lg);
      border-top: 1px solid var(--border);
    }

    .doc-content h2:first-of-type {
      margin-top: var(--space-xl);
      border-top: none;
      padding-top: 0;
    }

    .doc-content h3 {
      font-size: var(--text-lg);
      margin-top: var(--space-xl);
      margin-bottom: var(--space-md);
    }

    .doc-content p {
      color: var(--text-secondary);
      line-height: 1.7;
      margin-bottom: var(--space-md);
    }

    .doc-content code {
      background: var(--bg-secondary);
      padding: 2px 6px;
      border-radius: var(--radius-sm);
      font-family: var(--font-mono);
      font-size: 0.9em;
    }

    /* API Endpoint */
    .api-endpoint {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-lg);
      overflow: hidden;
    }

    .api-header {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-md);
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border);
    }

    .api-method {
      padding: var(--space-xs) var(--space-sm);
      border-radius: var(--radius-sm);
      font-family: var(--font-mono);
      font-size: var(--text-xs);
      font-weight: 600;
    }

    .api-method.get { background: rgba(0,212,255,0.2); color: var(--accent-cyan); }
    .api-method.post { background: rgba(0,255,148,0.2); color: var(--accent-green); }
    .api-method.patch { background: rgba(255,180,0,0.2); color: var(--accent-orange); }
    .api-method.delete { background: rgba(255,107,107,0.2); color: var(--accent-red); }

    .api-path {
      font-family: var(--font-mono);
      font-size: var(--text-sm);
      flex: 1;
    }

    .api-auth {
      font-size: var(--text-xs);
      color: var(--text-muted);
      padding: 2px 8px;
      background: rgba(255,255,255,0.05);
      border-radius: var(--radius-sm);
    }

    .api-body {
      padding: var(--space-md);
    }

    .api-desc {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      margin-bottom: var(--space-md);
    }

    .api-example {
      background: #0d1117;
      border-radius: var(--radius-md);
      padding: var(--space-md);
      font-family: var(--font-mono);
      font-size: var(--text-xs);
      overflow-x: auto;
    }

    .api-example .comment { color: #6e7681; }
    .api-example .key { color: #79c0ff; }
    .api-example .string { color: #a5d6ff; }
    .api-example .number { color: #79c0ff; }

    /* Code Block */
    .code-block {
      background: #0d1117;
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-md);
      font-family: var(--font-mono);
      font-size: var(--text-xs);
      overflow-x: auto;
      margin-bottom: var(--space-md);
    }

    .code-block .comment { color: #6e7681; }
    .code-block .prompt { color: var(--accent-cyan); }
    .code-block .output { color: var(--text-secondary); }

    /* Table */
    .doc-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: var(--space-lg);
      font-size: var(--text-sm);
    }

    .doc-table th,
    .doc-table td {
      padding: var(--space-sm) var(--space-md);
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    .doc-table th {
      background: var(--bg-secondary);
      font-weight: 600;
      color: var(--text-primary);
    }

    .doc-table td {
      color: var(--text-secondary);
    }

    .doc-table code {
      font-size: var(--text-xs);
    }

    /* Note Box */
    .note {
      background: rgba(0,212,255,0.05);
      border: 1px solid rgba(0,212,255,0.2);
      border-radius: var(--radius-md);
      padding: var(--space-md);
      margin-bottom: var(--space-lg);
    }

    .note-title {
      font-weight: 600;
      color: var(--accent-cyan);
      margin-bottom: var(--space-xs);
      font-size: var(--text-sm);
    }

    .note p {
      font-size: var(--text-sm);
      margin-bottom: 0;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="nav">
    <div class="container nav-inner">
      <a href="index.html" class="nav-logo">
        <svg width="32" height="32" viewBox="0 0 36 36" fill="none">
          <rect width="36" height="36" rx="8" fill="url(#g1)"/>
          <path d="M18 8L26 12V24L18 28L10 24V12L18 8Z" stroke="white" stroke-width="1.5" fill="none"/>
          <circle cx="18" cy="16" r="3" fill="white"/>
          <circle cx="13" cy="22" r="2" fill="white" opacity="0.7"/>
          <circle cx="23" cy="22" r="2" fill="white" opacity="0.7"/>
          <defs><linearGradient id="g1" x1="0" y1="0" x2="36" y2="36"><stop stop-color="#0066FF"/><stop offset="1" stop-color="#00D4FF"/></linearGradient></defs>
        </svg>
        Claude Fleet
      </a>

      <div class="nav-links">
        <a href="index.html" class="nav-link">Home</a>
        <a href="documentation.html" class="nav-link active">Docs</a>
        <a href="demo.html" class="nav-link">Demo</a>
        <a href="autonomous-ops.html" class="nav-link">24/7 Ops</a>
      </div>

      <div class="nav-cta">
        <a href="https://github.com/sethdford/claude-fleet" class="btn btn-secondary btn-sm">GitHub</a>
        <a href="index.html#install" class="btn btn-primary btn-sm">Get Started</a>
      </div>
    </div>
  </nav>

  <main>
    <div class="container doc-layout">
      <!-- Sidebar Navigation -->
      <aside class="doc-sidebar">
        <div class="doc-nav-section">
          <div class="doc-nav-title">Getting Started</div>
          <a href="#installation" class="doc-nav-link">Installation</a>
          <a href="#authentication" class="doc-nav-link">Authentication</a>
        </div>
        <div class="doc-nav-section">
          <div class="doc-nav-title">Workers</div>
          <a href="#spawn" class="doc-nav-link">Spawning Workers</a>
          <a href="#workers-list" class="doc-nav-link">List Workers</a>
          <a href="#dismiss" class="doc-nav-link">Dismissing Workers</a>
        </div>
        <div class="doc-nav-section">
          <div class="doc-nav-title">Coordination</div>
          <a href="#blackboard" class="doc-nav-link">Blackboard</a>
          <a href="#mail" class="doc-nav-link">Mail System</a>
          <a href="#checkpoints" class="doc-nav-link">Checkpoints</a>
        </div>
        <div class="doc-nav-section">
          <div class="doc-nav-title">Workflows</div>
          <a href="#workflows" class="doc-nav-link">Workflow Engine</a>
          <a href="#templates" class="doc-nav-link">Templates</a>
        </div>
        <div class="doc-nav-section">
          <div class="doc-nav-title">Advanced</div>
          <a href="#websocket" class="doc-nav-link">WebSocket</a>
          <a href="#mcp" class="doc-nav-link">MCP Server</a>
        </div>
      </aside>

      <!-- Main Content -->
      <div class="doc-content">
        <h1>API <span class="gradient-text">Documentation</span></h1>
        <p>Complete reference for the Claude Fleet REST API, WebSocket events, and MCP integration.</p>

        <div class="note">
          <div class="note-title">Base URL</div>
          <p>All endpoints are relative to <code>http://localhost:3847</code> by default. Configure with the <code>PORT</code> environment variable.</p>
        </div>

        <!-- Installation -->
        <h2 id="installation">Installation</h2>
        <p>Install Claude Fleet globally via npm:</p>
        <div class="code-block">
<span class="prompt">$</span> npm install -g claude-fleet
<span class="prompt">$</span> claude-fleet
<span class="output">Claude Fleet Server v2.0</span>
<span class="output">HTTP API:    http://localhost:3847</span>
<span class="output">WebSocket:   ws://localhost:3847/ws</span>
        </div>

        <!-- Authentication -->
        <h2 id="authentication">Authentication</h2>
        <p>Claude Fleet uses JWT tokens for authentication. Obtain a token by authenticating with your handle and team name.</p>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method post">POST</span>
            <span class="api-path">/auth</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Authenticate and receive a JWT token.</div>
            <div class="api-example">
{
  <span class="key">"handle"</span>: <span class="string">"team-lead-1"</span>,
  <span class="key">"teamName"</span>: <span class="string">"my-team"</span>,
  <span class="key">"agentType"</span>: <span class="string">"team-lead"</span>  <span class="comment">// or "worker"</span>
}
            </div>
          </div>
        </div>

        <p>Include the token in subsequent requests:</p>
        <div class="code-block">
Authorization: Bearer &lt;your-token&gt;
        </div>

        <table class="doc-table">
          <tr>
            <th>Role</th>
            <th>Description</th>
          </tr>
          <tr>
            <td><code>team-lead</code></td>
            <td>Can spawn workers, dismiss workers, manage swarms</td>
          </tr>
          <tr>
            <td><code>worker</code></td>
            <td>Can read tasks, post to blackboard, send mail</td>
          </tr>
        </table>

        <!-- Spawning Workers -->
        <h2 id="spawn">Spawning Workers</h2>
        <p>Spawn a new Claude Code worker instance. Workers run in isolated git worktrees.</p>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method post">POST</span>
            <span class="api-path">/orchestrate/spawn</span>
            <span class="api-auth">team-lead</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Spawn a new worker with a specific task.</div>
            <div class="api-example">
{
  <span class="key">"handle"</span>: <span class="string">"worker-alpha"</span>,
  <span class="key">"prompt"</span>: <span class="string">"Analyze the auth module and document the flow"</span>,
  <span class="key">"teamName"</span>: <span class="string">"my-team"</span>,
  <span class="key">"swarmId"</span>: <span class="string">"feature-auth"</span>,
  <span class="key">"workDir"</span>: <span class="string">"/path/to/repo"</span>
}
            </div>
          </div>
        </div>

        <!-- List Workers -->
        <h2 id="workers-list">List Workers</h2>
        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method get">GET</span>
            <span class="api-path">/orchestrate/workers</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Get all active workers and their status.</div>
            <div class="api-example">
<span class="comment">// Response</span>
[
  {
    <span class="key">"handle"</span>: <span class="string">"worker-alpha"</span>,
    <span class="key">"state"</span>: <span class="string">"running"</span>,
    <span class="key">"health"</span>: <span class="string">"healthy"</span>,
    <span class="key">"teamName"</span>: <span class="string">"my-team"</span>,
    <span class="key">"worktreePath"</span>: <span class="string">"/path/to/worktree"</span>
  }
]
            </div>
          </div>
        </div>

        <!-- Dismiss Workers -->
        <h2 id="dismiss">Dismissing Workers</h2>
        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method post">POST</span>
            <span class="api-path">/orchestrate/dismiss/:handle</span>
            <span class="api-auth">team-lead</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Gracefully dismiss a worker and clean up its worktree.</div>
          </div>
        </div>

        <!-- Blackboard -->
        <h2 id="blackboard">Blackboard</h2>
        <p>The blackboard is a shared message board for worker coordination. Workers post discoveries, and others can subscribe to updates.</p>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method post">POST</span>
            <span class="api-path">/blackboard</span>
            <span class="api-auth">team-lead</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Post a message to the blackboard.</div>
            <div class="api-example">
{
  <span class="key">"swarmId"</span>: <span class="string">"feature-auth"</span>,
  <span class="key">"category"</span>: <span class="string">"discovery"</span>,
  <span class="key">"message"</span>: <span class="string">"Found security issue in auth.ts:142"</span>,
  <span class="key">"author"</span>: <span class="string">"worker-alpha"</span>,
  <span class="key">"priority"</span>: <span class="string">"high"</span>
}
            </div>
          </div>
        </div>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method get">GET</span>
            <span class="api-path">/blackboard/:swarmId</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Read messages from the blackboard for a swarm.</div>
          </div>
        </div>

        <!-- Mail System -->
        <h2 id="mail">Mail System</h2>
        <p>Direct messaging between workers for targeted communication.</p>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method post">POST</span>
            <span class="api-path">/mail</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Send mail to another worker.</div>
            <div class="api-example">
{
  <span class="key">"from"</span>: <span class="string">"worker-alpha"</span>,
  <span class="key">"to"</span>: <span class="string">"worker-beta"</span>,
  <span class="key">"subject"</span>: <span class="string">"API analysis complete"</span>,
  <span class="key">"body"</span>: <span class="string">"The endpoints are documented in /docs/api.md"</span>
}
            </div>
          </div>
        </div>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method get">GET</span>
            <span class="api-path">/mail/:handle</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Get all mail for a worker.</div>
          </div>
        </div>

        <!-- Checkpoints -->
        <h2 id="checkpoints">Checkpoints</h2>
        <p>Workers can create checkpoints to persist their state for crash recovery or handoff.</p>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method post">POST</span>
            <span class="api-path">/checkpoints</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Create a checkpoint with worker state.</div>
            <div class="api-example">
{
  <span class="key">"handle"</span>: <span class="string">"worker-alpha"</span>,
  <span class="key">"state"</span>: { <span class="comment">/* arbitrary JSON */</span> },
  <span class="key">"status"</span>: <span class="string">"in_progress"</span>
}
            </div>
          </div>
        </div>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method get">GET</span>
            <span class="api-path">/checkpoints/latest/:handle</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Get the most recent checkpoint for a worker.</div>
          </div>
        </div>

        <!-- Workflows -->
        <h2 id="workflows">Workflow Engine</h2>
        <p>DAG-based workflow execution for complex multi-step operations.</p>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method post">POST</span>
            <span class="api-path">/workflows</span>
            <span class="api-auth">team-lead</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Create a workflow definition.</div>
            <div class="api-example">
{
  <span class="key">"name"</span>: <span class="string">"feature-development"</span>,
  <span class="key">"steps"</span>: [
    { <span class="key">"id"</span>: <span class="string">"analyze"</span>, <span class="key">"type"</span>: <span class="string">"spawn"</span>, <span class="key">"config"</span>: {...} },
    { <span class="key">"id"</span>: <span class="string">"implement"</span>, <span class="key">"dependsOn"</span>: [<span class="string">"analyze"</span>], ... }
  ]
}
            </div>
          </div>
        </div>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method post">POST</span>
            <span class="api-path">/workflows/:id/start</span>
            <span class="api-auth">team-lead</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Start executing a workflow.</div>
          </div>
        </div>

        <!-- Templates -->
        <h2 id="templates">Swarm Templates</h2>
        <p>Pre-defined swarm configurations for common development patterns.</p>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method get">GET</span>
            <span class="api-path">/templates</span>
          </div>
          <div class="api-body">
            <div class="api-desc">List all available swarm templates.</div>
          </div>
        </div>

        <div class="api-endpoint">
          <div class="api-header">
            <span class="api-method post">POST</span>
            <span class="api-path">/templates/:id/run</span>
            <span class="api-auth">team-lead</span>
          </div>
          <div class="api-body">
            <div class="api-desc">Run a swarm template with custom parameters.</div>
            <div class="api-example">
{
  <span class="key">"teamName"</span>: <span class="string">"my-team"</span>,
  <span class="key">"workDir"</span>: <span class="string">"/path/to/repo"</span>,
  <span class="key">"variables"</span>: {
    <span class="key">"feature"</span>: <span class="string">"authentication"</span>
  }
}
            </div>
          </div>
        </div>

        <!-- WebSocket -->
        <h2 id="websocket">WebSocket Events</h2>
        <p>Connect to <code>ws://localhost:3847/ws</code> for real-time updates.</p>

        <div class="code-block">
<span class="comment">// Authenticate after connection</span>
{ <span class="key">"type"</span>: <span class="string">"auth"</span>, <span class="key">"token"</span>: <span class="string">"your-jwt-token"</span> }

<span class="comment">// Subscribe to updates</span>
{ <span class="key">"type"</span>: <span class="string">"subscribe"</span>, <span class="key">"chatId"</span>: <span class="string">"team-channel"</span> }
        </div>

        <table class="doc-table">
          <tr>
            <th>Event</th>
            <th>Description</th>
          </tr>
          <tr>
            <td><code>worker_spawned</code></td>
            <td>A new worker has been spawned</td>
          </tr>
          <tr>
            <td><code>worker_output</code></td>
            <td>Output from a worker</td>
          </tr>
          <tr>
            <td><code>worker_dismissed</code></td>
            <td>A worker has been dismissed</td>
          </tr>
        </table>

        <!-- MCP -->
        <h2 id="mcp">MCP Server</h2>
        <p>Claude Fleet includes an MCP server for integration with MCP-compatible clients.</p>

        <div class="code-block">
<span class="comment"># Add to your MCP config</span>
{
  <span class="key">"mcpServers"</span>: {
    <span class="key">"claude-fleet"</span>: {
      <span class="key">"command"</span>: <span class="string">"npx"</span>,
      <span class="key">"args"</span>: [<span class="string">"claude-fleet"</span>, <span class="string">"--mcp"</span>]
    }
  }
}
        </div>

        <table class="doc-table">
          <tr>
            <th>Tool</th>
            <th>Description</th>
          </tr>
          <tr>
            <td><code>fleet_spawn</code></td>
            <td>Spawn a new worker</td>
          </tr>
          <tr>
            <td><code>fleet_list_workers</code></td>
            <td>List active workers</td>
          </tr>
          <tr>
            <td><code>fleet_dismiss</code></td>
            <td>Dismiss a worker</td>
          </tr>
          <tr>
            <td><code>fleet_blackboard_post</code></td>
            <td>Post to the blackboard</td>
          </tr>
          <tr>
            <td><code>fleet_blackboard_read</code></td>
            <td>Read from the blackboard</td>
          </tr>
        </table>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-bottom" style="margin-top: 0; padding-top: 0; border-top: none;">
        <div class="nav-logo" style="font-size: var(--text-sm);">
          <svg width="24" height="24" viewBox="0 0 36 36" fill="none">
            <rect width="36" height="36" rx="8" fill="url(#g2)"/>
            <path d="M18 8L26 12V24L18 28L10 24V12L18 8Z" stroke="white" stroke-width="1.5" fill="none"/>
            <circle cx="18" cy="16" r="3" fill="white"/>
            <defs><linearGradient id="g2" x1="0" y1="0" x2="36" y2="36"><stop stop-color="#0066FF"/><stop offset="1" stop-color="#00D4FF"/></linearGradient></defs>
          </svg>
          Claude Fleet
        </div>
        <div style="display: flex; gap: var(--space-xl);">
          <a href="https://github.com/sethdford/claude-fleet" style="color: var(--text-secondary); text-decoration: none; font-size: var(--text-sm);">GitHub</a>
          <a href="https://www.npmjs.com/package/claude-fleet" style="color: var(--text-secondary); text-decoration: none; font-size: var(--text-sm);">NPM</a>
        </div>
        <span>MIT License</span>
      </div>
    </div>
  </footer>
</body>
</html>
